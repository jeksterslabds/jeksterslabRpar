<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Notes: future_plan â€¢ jeksterslabRpar</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Notes: future_plan">
<meta property="og:description" content="jeksterslabRpar">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">jeksterslabRpar</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../../articles/jeksterslabRpar.html">Get started</a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/notes/notes_future_plan.html">Notes: future_plan</a>
    </li>
    <li>
      <a href="../../articles/resources/Baolai_2016.html">Parallel and High Performace Computing with R</a>
    </li>
    <li>
      <a href="../../articles/resources/Bengtsson.html">Future: Simple Async, Parallel &amp; Distributed Processing in R - What's Next?</a>
    </li>
    <li>
      <a href="../../articles/resources/Lewis_2020.html">Parallel computing with R using foreach, future, and other packages</a>
    </li>
    <li>
      <a href="../../articles/resources/Sevcikova_2017.html">Introduction to Parallel Computing with R (useR!2017)</a>
    </li>
    <li>
      <a href="../../articles/tests/test_future_plan.html">Test: future_plan</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jeksterslabds/jeksterslabRpar/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="notes_future_plan_files/header-attrs-2.3/header-attrs.js"></script><script src="notes_future_plan_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Notes: future_plan</h1>
                        <h4 class="author">Ivan Jacob Agaloos Pesigan</h4>
            
            <h4 class="date">2020-07-16</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jeksterslabds/jeksterslabRpar/blob/master/vignettes/notes/notes_future_plan.Rmd"><code>vignettes/notes/notes_future_plan.Rmd</code></a></small>
      <div class="hidden name"><code>notes_future_plan.Rmd</code></div>

    </div>

    
    
<div id="examples-of-using-future_plan-in-the-context-of-foreach" class="section level2">
<h2 class="hasAnchor">
<a href="#examples-of-using-future_plan-in-the-context-of-foreach" class="anchor"></a>Examples of using <code>future_plan()</code> in the context of <code>foreach()</code>
</h2>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">foreach</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">parallel</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">future</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">doFuture</span>)
<span class="co">#&gt; Loading required package: globals</span>
<span class="co">#&gt; Loading required package: iterators</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">microbenchmark</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">jeksterslabRpar</span>)</pre></body></html></div>
<p>This function quickly enables the user to toggle between <code>sequential</code> and <code>multiprocess</code> strategies with an option to set a custom strategy when needed. To set <code>strategy</code> to <code>sequential</code>, specify <code>par = FALSE</code>. To set <code>strategy</code> to <code>multiprocess</code>, specify <code>par = FALSE</code>. When used with <code><a href="https://rdrr.io/pkg/foreach/man/foreach.html">foreach()</a></code>, this function enables the user to set the future <code>strategy</code> with ease and without making changes to the funtion that executes the task.</p>
<div id="sequential" class="section level3">
<h3 class="hasAnchor">
<a href="#sequential" class="anchor"></a>Sequential</h3>
<p>In the case below, the <code><a href="https://rdrr.io/pkg/foreach/man/foreach.html">foreach()</a></code> function call is evaluated using the <code>sequential</code> strategy.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="../../reference/future_plan.html">future_plan</a></span>(<span class="kw">par</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="fu"><a href="https://rdrr.io/pkg/foreach/man/foreach.html">foreach</a></span>(<span class="kw">i</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fl">5</span>) <span class="kw">%dopar%</span> {
  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="kw">n</span> <span class="kw">=</span> <span class="fl">5</span>)
}
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; [1]  0.3901403 -0.8758094  1.2039327  1.3722790  1.1250096</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; [1]  0.08473542 -0.62882313 -0.83636575 -0.43871730 -1.16701111</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt; [1] -1.9944311 -0.1901856  1.0562226 -0.2733943 -0.8936663</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[4]]</span>
<span class="co">#&gt; [1] 0.50984233 0.07273648 0.56024582 0.92131693 1.34147758</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[5]]</span>
<span class="co">#&gt; [1] -0.1649566 -1.1950234 -1.7518774  0.2710248  1.4170188</span></pre></body></html></div>
</div>
<div id="multiprocess" class="section level3">
<h3 class="hasAnchor">
<a href="#multiprocess" class="anchor"></a>Multiprocess</h3>
<p>Below is an example of using the <code>multiprocess</code> strategy.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="../../reference/future_plan.html">future_plan</a></span>(<span class="kw">par</span> <span class="kw">=</span> <span class="fl">TRUE</span>)
<span class="fu"><a href="https://rdrr.io/pkg/foreach/man/foreach.html">foreach</a></span>(<span class="kw">i</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fl">5</span>) <span class="kw">%dopar%</span> {
  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="kw">n</span> <span class="kw">=</span> <span class="fl">5</span>)
}
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; [1]  0.01431863  0.01037052  1.22750928  2.03579190 -0.40555448</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; [1]  0.7030681  0.6704478  1.1795602 -0.2481653  0.6196518</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt; [1]  0.1528229  0.6782343 -0.6779716 -1.0672053  1.1744631</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[4]]</span>
<span class="co">#&gt; [1] -0.92057422 -0.03819978  0.02399367 -0.79311700 -0.44418588</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[5]]</span>
<span class="co">#&gt; [1] -0.53133436  0.04459807  1.14961884  1.42055689 -1.49284220</span></pre></body></html></div>
</div>
</div>
<div id="benchmarking" class="section level2">
<h2 class="hasAnchor">
<a href="#benchmarking" class="anchor"></a>Benchmarking</h2>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="co"># variables used repeatedly</span>
<span class="no">R</span> <span class="kw">&lt;-</span> <span class="fl">1000</span>
<span class="no">n</span> <span class="kw">&lt;-</span> <span class="fl">100</span>
<span class="no">benchmark_times</span> <span class="kw">&lt;-</span> <span class="fl">100</span>
<span class="no">X</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(
  <span class="kw">x</span> <span class="kw">=</span> <span class="no">n</span>,
  <span class="kw">times</span> <span class="kw">=</span> <span class="no">R</span>
)
<span class="no">FUN</span> <span class="kw">&lt;-</span> <span class="no">rnorm</span>
<span class="no">ncores</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html">detectCores</a></span>()</pre></body></html></div>
<p>The goal is to generate 1000 random normal data sets with a sample size of 100 each. The benchmark is run 100 times.</p>
<p>For easier comparison, the <code>R</code> code above are wrapped in a function called <code>foreach_future()</code>. Other similar implementations of the same task are explored.</p>
<div id="functions" class="section level3">
<h3 class="hasAnchor">
<a href="#functions" class="anchor"></a>Functions</h3>
<div id="future_plan" class="section level4">
<h4 class="hasAnchor">
<a href="#future_plan" class="anchor"></a><code>future_plan</code>
</h4>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">foreach_future</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">par</span>, <span class="no">foreach_seq</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="no">R</span>, <span class="no">n</span>) {
  <span class="co"># set strategy</span>
  <span class="fu"><a href="../../reference/future_plan.html">future_plan</a></span>(<span class="kw">par</span> <span class="kw">=</span> <span class="no">par</span>, <span class="kw">foreach_seq</span> <span class="kw">=</span> <span class="no">foreach_seq</span>)
  <span class="co"># for loop</span>
  <span class="fu"><a href="https://rdrr.io/pkg/foreach/man/foreach.html">foreach</a></span>(<span class="kw">i</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="no">R</span>) <span class="kw">%dopar%</span> {
    <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="kw">n</span> <span class="kw">=</span> <span class="no">n</span>)
  }
  <span class="co"># back to sequential after use</span>
  <span class="fu"><a href="../../reference/future_plan.html">future_plan</a></span>(<span class="kw">par</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
}</pre></body></html></div>
</div>
<div id="vanilla-for-loop" class="section level4">
<h4 class="hasAnchor">
<a href="#vanilla-for-loop" class="anchor"></a>Vanilla for <code>loop</code>
</h4>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">for_loop</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">R</span>, <span class="no">n</span>) {
  <span class="no">out</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">vector</a></span>(
    <span class="kw">mode</span> <span class="kw">=</span> <span class="st">"list"</span>,
    <span class="kw">length</span> <span class="kw">=</span> <span class="no">R</span>
  )
  <span class="kw">for</span> (<span class="no">i</span> <span class="kw">in</span> <span class="fl">1</span>:<span class="no">R</span>) {
    <span class="no">out</span><span class="kw">[[</span><span class="no">i</span>]] <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="kw">n</span> <span class="kw">=</span> <span class="no">n</span>)
  }
  <span class="no">out</span>
}</pre></body></html></div>
</div>
<div id="par_lapply" class="section level4">
<h4 class="hasAnchor">
<a href="#par_lapply" class="anchor"></a><code>par_lapply()</code>
</h4>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">par_lapply</span>
<span class="co">#&gt; function (X, FUN, ..., par = TRUE, ncores = NULL, mc = TRUE, </span>
<span class="co">#&gt;     lb = FALSE, cl_eval = FALSE, cl_export = FALSE, cl_expr, </span>
<span class="co">#&gt;     cl_vars, rbind = NULL) </span>
<span class="co">#&gt; {</span>
<span class="co">#&gt;     run_mclapply &lt;- run_parLapplyLB &lt;- run_parLapply &lt;- setup_cluster &lt;- run_lapply &lt;- FALSE</span>
<span class="co">#&gt;     if (par) {</span>
<span class="co">#&gt;         blas_set_num_threads(threads = 1)</span>
<span class="co">#&gt;         on.exit(blas_set_num_threads(threads = blas_get_num_procs()))</span>
<span class="co">#&gt;         get_os &lt;- function() {</span>
<span class="co">#&gt;             sysinf &lt;- Sys.info()</span>
<span class="co">#&gt;             if (!is.null(sysinf)) {</span>
<span class="co">#&gt;                 os &lt;- sysinf["sysname"]</span>
<span class="co">#&gt;                 if (os == "Darwin") {</span>
<span class="co">#&gt;                   os &lt;- "osx"</span>
<span class="co">#&gt;                 }</span>
<span class="co">#&gt;             }</span>
<span class="co">#&gt;             else {</span>
<span class="co">#&gt;                 os &lt;- .Platform$OS.type</span>
<span class="co">#&gt;                 if (grepl("^darwin", R.version$os)) {</span>
<span class="co">#&gt;                   os &lt;- "osx"</span>
<span class="co">#&gt;                 }</span>
<span class="co">#&gt;                 if (grepl("linux-gnu", R.version$os)) {</span>
<span class="co">#&gt;                   os &lt;- "linux"</span>
<span class="co">#&gt;                 }</span>
<span class="co">#&gt;             }</span>
<span class="co">#&gt;             tolower(os)</span>
<span class="co">#&gt;         }</span>
<span class="co">#&gt;         os &lt;- get_os()</span>
<span class="co">#&gt;         if (os == "windows") {</span>
<span class="co">#&gt;             mc &lt;- FALSE</span>
<span class="co">#&gt;         }</span>
<span class="co">#&gt;         if (is.null(ncores)) {</span>
<span class="co">#&gt;             ncores &lt;- detectCores()</span>
<span class="co">#&gt;         }</span>
<span class="co">#&gt;         if (mc) {</span>
<span class="co">#&gt;             run_mclapply &lt;- TRUE</span>
<span class="co">#&gt;         }</span>
<span class="co">#&gt;         else {</span>
<span class="co">#&gt;             if (lb) {</span>
<span class="co">#&gt;                 run_parLapplyLB &lt;- TRUE</span>
<span class="co">#&gt;             }</span>
<span class="co">#&gt;             else {</span>
<span class="co">#&gt;                 run_parLapply &lt;- TRUE</span>
<span class="co">#&gt;             }</span>
<span class="co">#&gt;             setup_cluster &lt;- TRUE</span>
<span class="co">#&gt;         }</span>
<span class="co">#&gt;     }</span>
<span class="co">#&gt;     else {</span>
<span class="co">#&gt;         run_lapply &lt;- TRUE</span>
<span class="co">#&gt;     }</span>
<span class="co">#&gt;     if (!is.null(rbind)) {</span>
<span class="co">#&gt;         bind &lt;- TRUE</span>
<span class="co">#&gt;         if (rbind) {</span>
<span class="co">#&gt;             do_call_what &lt;- "rbind"</span>
<span class="co">#&gt;         }</span>
<span class="co">#&gt;         else {</span>
<span class="co">#&gt;             do_call_what &lt;- "cbind"</span>
<span class="co">#&gt;         }</span>
<span class="co">#&gt;     }</span>
<span class="co">#&gt;     else {</span>
<span class="co">#&gt;         bind &lt;- FALSE</span>
<span class="co">#&gt;     }</span>
<span class="co">#&gt;     if (setup_cluster) {</span>
<span class="co">#&gt;         cl &lt;- makeCluster(ncores)</span>
<span class="co">#&gt;         if (cl_eval) {</span>
<span class="co">#&gt;             clusterEvalQ(cl, expr = cl_expr)</span>
<span class="co">#&gt;         }</span>
<span class="co">#&gt;         if (cl_export) {</span>
<span class="co">#&gt;             clusterExport(cl, varlist = cl_vars)</span>
<span class="co">#&gt;         }</span>
<span class="co">#&gt;         on.exit(stopCluster(cl))</span>
<span class="co">#&gt;     }</span>
<span class="co">#&gt;     if (run_mclapply) {</span>
<span class="co">#&gt;         out &lt;- mclapply(X = X, FUN = FUN, mc.cores = ncores, </span>
<span class="co">#&gt;             ...)</span>
<span class="co">#&gt;     }</span>
<span class="co">#&gt;     if (run_parLapply) {</span>
<span class="co">#&gt;         out &lt;- parLapply(cl = cl, X = X, fun = FUN, ...)</span>
<span class="co">#&gt;     }</span>
<span class="co">#&gt;     if (run_parLapplyLB) {</span>
<span class="co">#&gt;         out &lt;- parLapplyLB(cl = cl, X = X, fun = FUN, ...)</span>
<span class="co">#&gt;     }</span>
<span class="co">#&gt;     blas_set_num_threads(threads = blas_get_num_procs())</span>
<span class="co">#&gt;     if (run_lapply) {</span>
<span class="co">#&gt;         out &lt;- lapply(X = X, FUN = FUN, ...)</span>
<span class="co">#&gt;     }</span>
<span class="co">#&gt;     if (bind) {</span>
<span class="co">#&gt;         out &lt;- do.call(what = do_call_what, args = out)</span>
<span class="co">#&gt;     }</span>
<span class="co">#&gt;     out</span>
<span class="co">#&gt; }</span>
<span class="co">#&gt; &lt;bytecode: 0x56108ed0f6b0&gt;</span>
<span class="co">#&gt; &lt;environment: namespace:jeksterslabRpar&gt;</span></pre></body></html></div>
</div>
</div>
<div id="microbenchmark" class="section level3">
<h3 class="hasAnchor">
<a href="#microbenchmark" class="anchor"></a>Microbenchmark</h3>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html">microbenchmark</a></span>(
  <span class="co"># Serial</span>
  <span class="kw">foreach_seq</span> <span class="kw">=</span> <span class="fu">foreach_future</span>(<span class="kw">par</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">foreach_seq</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">R</span> <span class="kw">=</span> <span class="no">R</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="no">n</span>),
  <span class="kw">sequential</span> <span class="kw">=</span> <span class="fu">foreach_future</span>(<span class="kw">par</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">foreach_seq</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">R</span> <span class="kw">=</span> <span class="no">R</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="no">n</span>),
  <span class="kw">lapply</span> <span class="kw">=</span> <span class="fu"><a href="../../reference/par_lapply.html">par_lapply</a></span>(<span class="kw">X</span> <span class="kw">=</span> <span class="no">X</span>, <span class="kw">FUN</span> <span class="kw">=</span> <span class="no">FUN</span>, <span class="kw">par</span> <span class="kw">=</span> <span class="fl">FALSE</span>),
  <span class="kw">for_loop</span> <span class="kw">=</span> <span class="fu">for_loop</span>(<span class="kw">R</span> <span class="kw">=</span> <span class="no">R</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="no">n</span>),
  <span class="co"># Parallel</span>
  <span class="co">## Future</span>
  <span class="kw">multiprocess</span> <span class="kw">=</span> <span class="fu">foreach_future</span>(<span class="kw">par</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">R</span> <span class="kw">=</span> <span class="no">R</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="no">n</span>),
  <span class="kw">multisession</span> <span class="kw">=</span> <span class="fu">foreach_future</span>(<span class="kw">par</span> <span class="kw">=</span> <span class="no">multisession</span>, <span class="kw">R</span> <span class="kw">=</span> <span class="no">R</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="no">n</span>),
  <span class="co">## Parallel versions of lapply</span>
  <span class="kw">mclapply</span> <span class="kw">=</span> <span class="fu"><a href="../../reference/par_lapply.html">par_lapply</a></span>(<span class="kw">X</span> <span class="kw">=</span> <span class="no">X</span>, <span class="kw">FUN</span> <span class="kw">=</span> <span class="no">FUN</span>, <span class="kw">par</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">mc</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">ncores</span> <span class="kw">=</span> <span class="no">ncores</span>),
  <span class="kw">parLapply</span> <span class="kw">=</span> <span class="fu"><a href="../../reference/par_lapply.html">par_lapply</a></span>(<span class="kw">X</span> <span class="kw">=</span> <span class="no">X</span>, <span class="kw">FUN</span> <span class="kw">=</span> <span class="no">FUN</span>, <span class="kw">par</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">mc</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">ncores</span> <span class="kw">=</span> <span class="no">ncores</span>),
  <span class="kw">parLapplyLB</span> <span class="kw">=</span> <span class="fu"><a href="../../reference/par_lapply.html">par_lapply</a></span>(<span class="kw">X</span> <span class="kw">=</span> <span class="no">X</span>, <span class="kw">FUN</span> <span class="kw">=</span> <span class="no">FUN</span>, <span class="kw">par</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">mc</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">lb</span> <span class="kw">=</span> <span class="fl">TRUE</span>, <span class="kw">ncores</span> <span class="kw">=</span> <span class="no">ncores</span>),
  <span class="kw">times</span> <span class="kw">=</span> <span class="no">benchmark_times</span>
)
<span class="co">#&gt; Unit: milliseconds</span>
<span class="co">#&gt;          expr         min          lq        mean      median         uq</span>
<span class="co">#&gt;   foreach_seq  134.290621  142.304937  155.524374  152.402137  162.06050</span>
<span class="co">#&gt;    sequential  135.617046  155.941335  170.395733  167.257672  176.54041</span>
<span class="co">#&gt;        lapply    6.225572    6.630271    9.638475    7.040061   11.46580</span>
<span class="co">#&gt;      for_loop    6.147767    6.489384    9.498845    6.853103   11.40134</span>
<span class="co">#&gt;  multiprocess  224.206575  263.784520  281.988866  278.855230  304.84607</span>
<span class="co">#&gt;  multisession 2712.934679 2793.806146 2886.209915 2844.586517 2925.28416</span>
<span class="co">#&gt;      mclapply   15.180833   20.391300   26.513782   22.751221   29.01165</span>
<span class="co">#&gt;     parLapply  242.373927  250.854591  273.638504  266.187531  282.76926</span>
<span class="co">#&gt;   parLapplyLB  243.518728  272.813994  297.027154  295.291018  316.71789</span>
<span class="co">#&gt;         max neval</span>
<span class="co">#&gt;   211.57947   100</span>
<span class="co">#&gt;   243.81553   100</span>
<span class="co">#&gt;    25.11211   100</span>
<span class="co">#&gt;    27.11147   100</span>
<span class="co">#&gt;   342.62019   100</span>
<span class="co">#&gt;  3342.07529   100</span>
<span class="co">#&gt;    57.04380   100</span>
<span class="co">#&gt;   396.77301   100</span>
<span class="co">#&gt;   425.38297   100</span></pre></body></html></div>
<p>Results from the benchmark for the current example shows that parallelizing a task does not necessarily improve speed relative to the serial counterpart. You have to consider the overhead cost of parallelizing your task and decide if the cost is tolerable in relation to the total time spent running a task. A good frame of mind is to make your code run efficiently on a single processor first and only parallelize when the overhead cost is worth taking. When you decide to parallelize, make sure to perform benchmarks to determine if you are going to get a significant increase in speed.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Ivan Jacob Agaloos Pesigan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
